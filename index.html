<html>
<body>
<pre>
===============================================================================================
1. Create R program to write a user defined functions and perform the following operations on user
input.
a. Check the number is even or odd
b. Print squares of numbers in sequence.
c. Find the factors of a given number.
d. Create vector of integers and sort them in ascending/descending order.
Solution:
================================================================================================
a. Check the number is even or odd
even_odd <-function(a ) #Function Definition
{
#of lines to be scanned
if(a %% 2 == 0)
{
print("The number is Even Number")
}
else
{
print("The number is Odd Number")
}
}
print("Enter the number to be checked")
a <-scan(nlines=1) #Scan function allows to read and nlines allows number
even_odd(a) #Function Call
b. Print squares of numbers in sequence.
sqr <- function (n)
{
print ("The Square of Numbers is:")
for(i in 0:n)
print(i^2)
}
print("Enter the Range:")
n <- scan(nlines=1)
sqr(n)
c. Find the factors of a given number.
print_factors = function(n) {
cat("The factors of",n,"are:")
for(i in 1:n) {
if((n %% i) == 0) {

}
}
}
print("Enter the Number:")
n <- scan(nlines=1)
print_factors(n)
d. Create vector of integers and sort them in ascending/descending order.
srt<-function(a){
v<-sort(a, decreasing = TRUE)
print("DESCENDING ORDER")
print(v)
x<-sort(a, decreasing = FALSE)
print("ASCENDING ORDER")
print(x)
}
a <-scan(nlines=6) #Scan function allows to read and nlines allows number
srt(a) #Function Call
===============================================================================================
2. Write a R program to create a list containing a vector, a matrix and a list and give names to the
elements in the list.
a. Count number of objects in a given list and Find the length of the first vector of a given list.
b. Access the first and third element of the list and extract all elements except the third element
of the first vector of a given list.
c. Add element at the end of the list and Update the third element of the list and remove the
last element.
d. Merge a list of vector to original list, convert a second and last element of a given list into
vector and add these two vectors.
Solution:
===============================================================================================
a. Count number of objects in a given list and Find the length of the first vector of a given
list.
list_data <- list(c("Red","Green","Black","Orange","Yellow"), matrix(c(1,3,5,7,9,11), nrow = 2),
list("Python", "PHP", "Java"))
print("List:")
print(list_data)
names(list_data) = c("Color", "Odd numbers", "Languages")
print("List with column names:")
print(list_data)
print("Number of objects in the said list:")
length(list_data)print("Length of the vector 'Color' of the said list")
print(length(list_data$Color))
b.Access the first and third element of the list and extract all elements except the third
element of the first vector of a given list.
print('1st element:')
print(list_data[1])
print('3rd element:')
print(list_data[3])
print("First vector without third element:")
list_data$Color = list_data$Color[-3]
print(list_data$Color)
c. Add element at the end of the list and Update the third element of the list and remove the
last element.
print("Add a new element at the end of the list:")
list_data[4] = "New element"
print("New list:")
print(list_data)
print("Update the third element of the list:")
list_data$Languages[4] = "R programming"
print("New list:")
print(list_data)
print("Remove the last element of the list:")
list_data[4] = NULL
print("New list:")
print(list_data)
d. Merge list of vectors to original list, convert a second and last element of a given list into
vector and add these two vectors.
n1 = list(c(1,2,3,5,6,7))
print("Merge the said lists:")
mlist = c(list_data, n1)
print("New merged list:")
print(mlist)
print(mlist[2])
print(mlist[4])
print("Convert the lists to vectors:")
v1 = unlist(mlist[2],use.names = FALSE)
v2 = unlist(mlist[4])
print(v1)
print(v2)
print("Add two vectors:")
v = v1 + v2
print("New vector:")
print(v)
===============================================================================================
3. Create matrices in R and perform the following operations on them.
a. Addition, Subtraction of two matrices and product of matrix and its transpose.
b. Column sum, Mean across rows, Total Sum of a matrix and Sort the matrix elements across
columns in ascending order.
c. Inverse of the matrix.
d. Find row and column index of maximum and minimum value in a given matrix.
e. Addition, Subtraction of two matrices and product of matrix and its transpose.
Solution:
======================================================================================================
a. Addition, Subtraction of two matrices and product of matrix and its transpose.
# Create two 3x3 matrices.
matrix1 <- matrix(c(2,1,1,1,1,-1,1,1,2), nrow=3,ncol=3)
print(matrix1)
matrix2 <- matrix(c(5, 2, 0, 9, 3, 4,2,3,2), nrow=3,ncol=3)
print(matrix2)
# Add the matrices.
result <- matrix1 + matrix2
cat("Result of addition","\n")
print(result)
# Subtract the matrices
result <- matrix1 - matrix2
cat("Result of subtraction","\n")
print(result)
# Product of matrix and its transpose.
result <- matrix1 %*% t(matrix1)
cat("Result of product of matrix and its transpose","\n")
print(result)
b. Column sum, Mean across rows, Total Sum of a matrix and Sort the matrix elements
across columns in ascending order.
#Column Sum
print("Column sum:")
colSums(matrix1)
print("Mean across rows:")
apply( matrix1, 1, mean)
print("Total sum:")
sum(matrix1)
print("Matrix elements in sorted order column wise:")
apply(matrix1, 2, sort)
c. Inverse of the matrix.
#Inverse of the matrix
invm=solve(matrix1)
print(invm)d. Find row and column index of maximum and minimum value in a given matrix
matrix2 <- matrix(c(5, 2, 0, 9, 3, 4,2,3,2), nrow=3,ncol=3)
print(matrix2)
result = which(matrix2 == max(matrix2), arr.ind=TRUE)
print("Row and column of maximum value of the said matrix:")
print(result)
result = which(matrix2 == min(matrix2), arr.ind=TRUE)
print("Row and column of minimum value of the said matrix:")
print(result)
=====================================================================
4. Create R program and perform the following operations on them.
a. Take user name as input string, display the number characters present in the string, convert
the string into uppercase and display the middle character of the string.
b. Create function called is_palindrome() that determines whether or not a given string is a
palindrome. The function should take a single parameter.
c. Create an ordered factor of 20 alternating pairs of 1s and 2s, label the data with the “ON”
and “OFF”.
Solution:
=========================================================================
a. Take user name as input string, display the number characters present in the string,
convert the string into uppercase and display the middle character of the string.
midf<-function(str){
print(nchar(str))
print(toupper(str))
n1<-nchar(str)+1
mc<-substring(str,n1%/%2,(n1+1)%/%2)
print(mc)
}
name<- readline("Enter your name:")
midf(name)
b. Create function called is_palindrome() that determines whether or not a given string is
a palindrome. The function should take a single parameter.
is_palindrome <- function(x){
a <- substring(x,seq(1,nchar(x)) , seq(1,nchar(x)))
paste(rev(a),sep="",collapse="") == paste(a,sep="",collapse="")
}
str<- readline("Enter string:")
print(is_palindrome(str))
c. Create an ordered factor of 20 alternating pairs of 1s and 2s, label the data with the
“ON” and “OFF”.
gl(2, 2, 20,labels = c("ON", "OFF"),ordered=TRUE)

==============================================================
5. Perform the following operations on Data Frame
a. Create the first data frame that contains student Details consisting of Student ID, and marks
for three subjects, namely, English, Maths, and Science. Create the second data frame with
column Student ID and State. Join both the data frames on Student ID.
b. Add the new subject ‘Social’ to joined data frame of (a) using cbind() function and add 2
more student details using rbind() function. Get the Student ID and state details.
c. Use the data frame of (b) and organize the data with respect to Student ID and State using
the melt() function. Use the molten data and reshape the data to its original form using cast()
function.
Solution:
========================================================================================
a. Create the first data frame that contains student Details consisting of Student ID, and marks
for three subjects, namely, English, Maths, and Science. Create the second data frame with
column Student ID and State. Join both the data frames on Student ID.
df1 = data.frame(StudentId = c(101:106),English=c(35,65,80,40,79,91),
Maths=c(40,50,70,35,56,89),Science=c(38,69,87,45,68,95))
print(df1)
df2 = data.frame(StudentId = c(101,102,104,106,107,108),State = c("Karnataka","Kerala",
"Karnataka","Andra Pradesh", " Maharashtra", "Delhi"))
print(df2)
df = merge(x = df1, y = df2, by = "StudentId")
print(df)
b. Add the new subject ‘Social’ to joined data frame of (a) using cbind() function and add 2
more student details using rbind() function. Get the Student ID and state details and Get
the maximum salary. Get the student details belongs to “Karnataka” State and Maths
marks greater than 50.
df=cbind(df, Social=c(46,67,78,70))
print(df)
# Create the second data frame
stu.newdata =
data.frame(StudentId=c(107,108),English=c(70,86),Maths=c(68,84),Science=c(63,83),Social=c(52,
73),State = c("Karnataka","Kerala"))
# Bind the two data frames.
stu.finaldata = rbind(df, stu.newdata)
print(stu.finaldata)
result <- data.frame(stu.finaldata$StudentId, stu.finaldata$State)
print(result)
c. Use the data frame of (b) and organize the data with respect to Student ID and State using
the melt() function. Use the molten data and reshape the data to its original form using cast()
function.
install.packages("reshape")#Loading the libraries
library(reshape)
# Original data frame
cat("Original data frame:\n")
print(df)
# Organize data w.r.t. StudentId and State
molten.data <- melt(stu.finaldata, id = c("StudentId","State"),variable ="Subjects")
cat("\nAfter melting data frame:\n")
print(molten.data)
# Reshaped data
cast.data <- cast(molten.data, StudentId+State~Subjects)
print(cast.data)


===============================================================================
8. Write an R program that accomplishes the following tasks by implementing user-defined functions:
a. Define a function to calculate the age of a person given their birthdate. The function should
take the birthdate as input and return the age in years.
b. Create a function that calculates the number of days between two given dates. The function
should accept two dates as inputs and return the difference in days.
c. Implement a function that takes a date and time in the format "YYYY-MM-DD
HH:MM:SS" and converts it into a more user-friendly format, displaying the day of the
week, month, day, and year along with the time in "Hour:Minute AM/PM" format.
d. Create a function that receives a date and time in the format "YYYY-MM-DD HH:MM:SS"
and returns the day of the year and the week number of the year.
Solution:
==================================================================================
a. Define a function to calculate the age of a person given their birthdate. The function
should take the birthdate as input and return the age in years.
# Define a function to calculate age
calculate_age <- function(birthdate) {
# Get the current date
current_date <- Sys.Date()
# Calculate the age in years
age <- as.integer(difftime(current_date, birthdate, units = "days") / 365.25)
return(age)
}
# Example usage
birthdate <- as.Date("1990-05-15")
age <- calculate_age(birthdate)
cat("Age:", age, "years")b. Create a function that calculates the number of days between two given dates. The
function should accept two dates as inputs and return the difference in days.
# Define a function to calculate days between two dates
calculate_days_between <- function(date1, date2) {
# Calculate the difference in days
days_difference <- as.integer(difftime(date2, date1, units = "days"))
return(days_difference)
}
# Example usage
date1 <- as.Date("2023-01-15")
date2 <- as.Date("2023-08-18")
days_diff <- calculate_days_between(date1, date2)
cat("Days between the two dates:", days_diff, "days")
c. Implement a function that takes a date and time in the format "YYYY-MM-DD
HH:MM:SS" and converts it into a more user-friendly format, displaying the day of
the week, month, day, and year along with the time in "Hour:Minute AM/PM"
format.
# Define a function to convert date and time format
convert_datetime_format <- function(datetime_string) {
# Convert string to POSIXct object
datetime <- as.POSIXct(datetime_string, format = "%Y-%m-%d %H:%M:%S")
# Format components
formatted_date <- format(datetime, format = "%A, %B %d, %Y")
formatted_time <- format(datetime, format = "%I:%M %p")
# Combine and return the formatted date and time
formatted_datetime <- paste(formatted_date, formatted_time)
return(formatted_datetime)
}
# Example usage
datetime_string <- "2023-08-18 14:30:00"
formatted_datetime <- convert_datetime_format(datetime_string)
cat("Formatted date and time:", formatted_datetime)
d. Create a function that receives a date and time in the format "YYYY-MM-DD
HH:MM:SS" and returns the day of the year and the week number of the year.
# Define a function to extract day of the year and week number
extract_day_and_week <- function(datetime_string) {
# Convert string to POSIXct object
datetime <- as.POSIXct(datetime_string, format = "%Y-%m-%d %H:%M:%S")
# Extract day of the year and week number
day_of_year <- as.numeric(format(datetime, format = "%j"))
week_number <- as.numeric(format(datetime, format = "%U"))
return(list(day_of_year = day_of_year, week_number = week_number))
}

datetime_string <- "2023-08-18 14:30:00"
result <- extract_day_and_week(datetime_string)
cat("Day of the year:", result$day_of_year, "\n")
cat("Week number of the year:", result$week_number)
==================================================================================================================
  part B

===============
1. Create a Data Frame in R for maintaining Employee Details using .csv file that contains 5
Employee Details consisting of Employee ID, Employee name, Salary, and Joining date
and perform the following analysis on it.
a. Get the structure of the data frame.
b. Add the Department column to existing data frame using cbind() function and add
2 employees details using rbind() function.
c. Get the employee's name and salary details and Get the maximum salary.
d. Get the persons in IT department whose salary is greater than 600 and Get the
employee name who joined on or after 2014.
  
Solution:
  
a. Get the structure of the data frame.
# Create the data frame.
emp.data <- read.csv("input.csv")
print(emp.data)
str(emp.data)
b. Add the Department column to existing data frame using cbind() function and add 2
employees details using rbind() function.
emp.data<-cbind(emp.data, dept=c("IT","Operations","IT","HR","Finance"))
print(emp.data)
# Create the second data frame
emp.newdata <- data.frame(id = c (6:8),
name = c("Rashmi","Pranab","Tushar"),
salary = c(578.0,722.5,632.8),
start_date = c("2013-05-21","2013-07-30","2014-06-17"),
dept = c("IT","Operations","Finance"))
# Bind the two data frames.
emp.finaldata <- rbind(emp.data,emp.newdata)
print(emp.finaldata)
c. Get the employee's name and salary details and Get the maximum salary.
# Get the max salary from data frame.
sal<-max(emp.finaldata$salary)
print(sal)

  result<-subset(emp.finaldata,salary==max(salary))
print(result)
result<-data.frame(emp.finaldata$name,emp.finaldata$salary)
print(result)
d. Get the persons in IT department whose salary is greater than 600 and Get the
employee name who joined on or after 2014.
result1<-subset(emp.finaldata,dept=='IT' &salary>600)
result2<-subset(emp.finaldata,as.Date(start_date)>as.Date('2014-01-01'))
print(result1)
print(result2)


  =======================================================================
  2. Perform the following operations on Data Frame
a. Create the first data frame that contains student Details consisting of Student ID,
and marks for three subjects, namely, English, Maths, and Science. Create the
second data frame with column Student ID and State. Join both the data frames on
Student ID.
b. Add the new subject ‘Social’ to joined data frame of (a) using cbind() function and
add 2 more student details using rbind() function. Get the Student ID and state
details. Get the student details belongs to “Karnataka” State and Maths marks
greater than 50.
c. Use the data frame of (b) and organize the data with respect to Student ID and State
using the melt() function. Use the molten data and reshape the data to its original
form using cast() function.
Solution:
a. Create the first data frame that contains student Details consisting of Student ID,
and marks for three subjects, namely, English, Maths, and Science. Create the
second data frame with column Student ID and State. Join both the data frames on
Student ID.
df1=data.frame(StudentId=c(101:106),
English=c(35,65,80,40,79,91),
Maths=c(40,50,70,35,56,89),
Science=c(38,69,87,45,68,95))
print(df1)
df2=data.frame(StudentId= c(101,102,104,106,107,108),
State=c("Karnataka","Kerala","Karnataka","AndraPradesh"," Maharashtra","Delhi"))
print(df2)
df = merge(x = df1, y = df2, by = "StudentId")
print(“Merged data:”)
print(df)
b. Add the new subject ‘Social’ to joined data frame of (a) using cbind() function and
add 2 more student details using rbind() function. Get the Student ID and state
details. Get the student details belongs to “Karnataka” State and Maths marks
greater than 50.
df=cbind(df,Social=c(46,67,78,70))
print(df)
# Create the second data frame
stu.newdata=data.frame(StudentId=c(107,108),
English=c(70,86),
Maths=c(68,84),
Science=c(63,83),
Social=c(52,73),
State =c("Karnataka","Kerala"))
# Bind the two data frames.
stu.finaldata = rbind(df, stu.newdata)
print(stu.finaldata)
info <- subset(stu.finaldata, Maths > 50 & State == "Karnataka")
print(info)
c. Use the data frame of (b) and organize the data with respect to Student ID and State
using the melt() function. Use the molten data and reshape the data to its original
form using cast() function.
install.packages("reshape")
#Loading the libraries library(reshape)
# Original data frame
cat("Original data frame:\n")print(df)
# Organize data w.r.t. StudentId and State
molten.data <- melt(df, id = c("StudentId","State"),variable ="Subjects")
cat("\nAfter melting data frame:\n")
print(molten.data)
# Reshaped data
cast.data <- cast(molten.data, StudentId+State~Subjects)
print(cast.data)
=========================================================================================================================

5. Create the data frame that contains student Details consisting of Student name, and
marks for three subjects, namely, Physics, Chemistry and Mathematics. Perform the
following analysis on it using dplyr library.
a. Use Select() function to print only column details starts with "Ph" and print
everything that contains "cs"
b. Display data in which Mathematics marks lie between 90 and 94 using filter()
c. Display the physics mark on sorted order using arrange() function and rename the
Chemistry column to CHEMISTRY using rename() function
d. Create the resultant data frame that contains new variable TotalMarks using
mutate() function.

  
Solution:

a. Use Select() function to print only column details starts with "Ph" and print
everything that contains "cs" .
# Create a data frame
dataframe <- data.frame( Name = c("Bhuwanesh", "Anil", "Jai", "Naveen"),
Physics = c(98, 87, 91, 94),
Chemistry = c(93, 84, 93, 87),
Mathematics = c(91, 86, 92, 83) )
print(dataframe)
library(dplyr)
print(select(dataframe, starts_with("Ph")))
print(select(dataframe, contains("cs")))
a. Display data in which mathematics marks lie between 90 and 94 using filter()
# Display
print(dataframe %>% filter(Mathematics > 90 & Mathematics < 94))
b. Display the physics mark on sorted order using arrange() function and rename the
Chemistry column to CHEMISTRY using rename() function
print(arrange(dataframe, Physics))
# Display the dataset
# after renaming a column
print(rename(dataframe, CHEMISTRY = Chemistry))

c. Create the resultant data frame that contains new variable TotalMarks using
mutate() function.
df1<-dataframe %>% mutate(
TotalMarks = Physics + Chemistry+ Mathematics)
print(df1)

======================================================================================================

7. Write a R program and perform following operations using tidyverse packages
a. Use the map() function to calculate the square of each value in a vector c(2, 4, 10, 15,
20) and calculate mean value of each vector in list<- list(c(1, 2, 3), c(4, 5, 6), c(7, 8,
NA)).
b. Use str_replace() function to replaces a pattern or string with another string and use
str_length() to find the length of each element of vector x<- c("R", "programming",
"Language").
c. Create the dataframe with letters and numbers and display the bar graph using
ggplot()
Solution:
a. Use the map() function to calculate the square of each value in a vector c(2, 4, 10, 15,
20) and calculate mean value of each vector in list<- list(c(1, 2, 3), c(4, 5, 6), c(7, 8,
NA)).

  
library(purrr)
#define vector
data <- c(2, 4, 0, 15, 20)
#calculate square of each value in the vector
data %>%map(function(x) x^2)
library(purrr)
#define list of vectors
data <- list(c(1, 2, 3),
c(4, 5, 6),
c(7, 8, NA))
#calculate mean value of each vector in list
data %>%map(mean, na.rm=TRUE)
b. Use str_replace() function to replaces a pattern or string with another string and use
str_length() to find the length of each element of vector x<- c("R", "programming",
"Language").
library("stringr")
myString = "Bhuwanesh Nainwal"
# Replace if string starts with "Bhuwanesh"
print(str_replace(myString, "^Bhuwanesh", "Harshit"))
# Replace if string ends with "Nainwal"
print(str_replace(myString, "Nainwal$", "")
x <- c("R", "programming", "Language")
print(str_length(x))
c. Create the dataframe with letters and numbers and display the bar graph using
ggplot()
library("ggplot2")
# create the dataframe with letters and numbers
gfg<-data.frame(x=c('A', 'B', 'C', 'D', 'E', 'F'),y=c(4, 6, 2, 9, 7, 3))
# display the bar
ggplot(gfg, aes(x, y, fill=x)) + geom_bar(stat="identity")
  
  ====================================================================

  
</pre>
</body>
</html>
